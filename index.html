<!DOCTYPE html> 
<html manifest="joco.appcache"> 
	<head> 
	<title>JoCo</title> 
	<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
	<meta name="apple-mobile-web-app-capable" content="yes" />
	<meta name="apple-mobile-web-app-status-bar-style" content="black" />
	<link rel="stylesheet" href="jquery.mobile/jquery.mobile-1.0.1.css" />
	<link rel="apple-touch-icon" href="apple-touch-icon.png" />
	<style type="text/css">
		.headertime {
			font-family: monospace;
		}
		.headersmall {
			font-size: smaller;
		}
		.ui-grid-b .ui-block-a {
			width: 15%;
		}
		.ui-grid-b .ui-block-b {
			width: 70%;
		}
		.ui-grid-b .ui-block-c {
			width: 15%;
		}
	</style>
	<script type="text/javascript" charset="utf-8" src="phonegap.js"></script>
	<script src="jquery/jquery-1.7.1.js"></script>
	<script src="jquery.mobile/jquery.mobile-1.0.1.js"></script>
	<script src="jquery.Storage/jquery.Storage.js"></script>
	<script src="json/json2.js"></script>
	<script type="text/javascript">

  var cache = window.applicationCache;

  if (typeof cache != 'undefined') {
    cache.addEventListener("cached", function () {
        console.log("All resources for this web app have now been downloaded. You can run this application while not connected to the internet");
    }, false);
    cache.addEventListener("checking", function () {
        console.log("Checking manifest");
    }, false);
    cache.addEventListener("downloading", function () {
        console.log("Starting download of cached files");
    }, false);
    cache.addEventListener("error", function (e) {
        console.log("There was an error in the manifest, downloading cached files or you're offline: " + e);
    }, false);
    cache.addEventListener("noupdate", function () {
        console.log("There was no update needed");
    }, false);
		/*
    cache.addEventListener("progress", function () {
        console.log("Downloading cached files");
    }, false);
		*/
    cache.addEventListener("updateready", function () {
        cache.swapCache();
        console.log("Updated cache is ready");
        // Even after swapping the cache the currently loaded page won't use it
        // until it is reloaded, so force a reload so it is current.
        window.location.reload(true);
    }, false);
  }

	var debug = true;
	var favorites = new Favorites();
	var refreshInterval = undefined;
	var reminderInterval = undefined;
	var jocoOnline = false;
	var normalTheme = 'c';
	var hilightTheme = 'e';

	var data = [];
	var pendingUpdates = [];
	
	function phoneGapAvailable() {
	  var ret = typeof(PhoneGap) != 'undefined';
		console.log("phoneGapAvailable = " + ret + ", typeof = " + typeof(PhoneGap));
		return ret;
	}

	var days = [ 'Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday' ];
	var months = [ 'January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December' ];

	// dateFormat.masks.joco = 'ddd, mmm d hh:MMTT';
	function formatTime(d) {
		var hour = String('0' + (d.getHours() % 12)).slice(-2);
		if (hour == '00') {
			hour = '12';
		}
		var ret = hour + ':' + String('0' + d.getMinutes()).slice(-2);
		if ((d.getHours() % 12) == d.getHours()) {
			ret += 'AM';
		} else {
			ret += 'PM';
		}
		return ret;
	}

	function formatDate(d) {
		return days[d.getDay()] + ', ' + months[d.getMonth()] + ' ' + d.getDate();
	}

	function getDateFromString(dateTimeString) {
		var dateTimeParts = dateTimeString.split('T');
		var dateParts = dateTimeParts[0].split('-');
		var timeParts = dateTimeParts[1].split(':');
		
		// console.log('year = ' + dateParts[0] + ', month = ' + dateParts[1] + ', day = ' + dateParts[2]);
		// console.log('hours = ' + timeParts[0] + ', minutes = ' + timeParts[1]);
		
		return new Date(dateParts[0], dateParts[1] - 1, dateParts[2], timeParts[0], timeParts[1], 0, 0);
	}

	function updateType(type) {
		setType(type);
		refresh();
		return true;
	}
	function setType(type) {
		if (type == undefined) {
			type = $("input[name='type-choice']:checked").val();
		}
		save('calendarType', type);
		return true;
	}
	
	function getType() {
		var type = get('calendarType');
		if (type == 'official' || type == 'unofficial' || type == 'favorite') {
			return type;
		}
		return 'official';
	}

	function Favorites() {
		this.contents = get('favorites');
		if (this.contents == undefined || ((typeof this.contents) != 'object') || (!this.contents.length)) {
			this.contents = [];
		}

		this.save = function() {
			save('favorites', this.contents);
			return true;
		}
		this.add = function(id) {
			console.log("add: " + id);
			this.contents.push(id);
			return true;
		}
		this.remove = function(id) {
			console.log("remove: " + id);
			for (var i = 0; i < this.contents.length; i++) {
				if (this.contents[i] == id) {
					this.contents.splice(i, 1);
					break;
				}
			}
			return true;
		}
		this.contains = function(id) {
			for (var i = 0; i < this.contents.length; i++) {
				if (this.contents[i] == id) {
					return true;
				}
			}
			return false;
		}
	}

	function isFavorite(id) {
		var fav = favorites.contains(id);
		return fav;
	}

	function favorite(id) {
		console.log("favorite(" + id + ")");
		return favorites.add(id);
	}

	function unfavorite(id) {
		console.log("unfavorite(" + id + ")");
		return favorites.remove(id);
	}

	function toggleFavorite(entryId) {
		var scheduleId = scheduleIds[entryId];
		if (scheduleId == undefined) {
			console.log("something went horribly wrong!");
			return;
		}

		if (favorites.contains(scheduleId)) {
			unfavorite(scheduleId);
			$('#favorite-' + entryId).attr('data-theme', normalTheme);
		} else {
			favorite(scheduleId);
			$('#favorite' + entryId).attr('data-theme', hilightTheme);
		}
		refresh();
	}

	var oneMinute = 60 * 1000;
	var fiveMinutes = 5 * oneMinute;
	var fifteenMinutes = 15 * oneMinute;

	function checkForReminders() {
		$.each(['official', 'unofficial'], function(i, type) {
			var type = get(type);
			if (type == undefined) {
				return;
			}
			$.each(get(type), function(j, entry) {
				if (isFavorite(entry.id)) {
					console.log('('+type+') ' + entry.title + " is a favorite.... checking for alarms");
					now = (new Date()).getTime();
					// round down to 5-minute interval
					adjusted = (now - (now % oneMinute));
					// alarm 15 minutes before the event
					alarmTime = entry.start - fifteenMinutes;

					console.log("adjusted time = " + new Date(adjusted));
					console.log("alarm time = " + new Date(alarmTime));
					if (adjusted >= alarmTime && adjusted < (alarmTime + oneMinute)) {
						var title = formatTime(entry.start) + ': ' + entry.title;
						var header = title;
						var contents = entry.contents;

						if (phoneGapAvailable()) {
							navigator.notification.alert(title, function() {}, contents, 'OK');
							navigator.notification.vibrate(500);
						} else {
							$('#alert-title').html(title);
							$('#alert-header').html(header);
							$('#alert-text').html(contents);
							$.mobile.changePage("#alert");
							$('#alert-title').html(title);
							console.log("BEEP!");
						}
					}
				}
			});
		});
	}

	var scheduleIds = [];

	function getAllEvents() {
		var events = [];
		$.each(['official', 'unofficial'], function(i, type) {
			$.each(get(type), function(i, entry) {
				events.push(entry);
			})
		});
		events.sort(function(a, b) {
			return a.start - b.start;
		});
		return events;
	}
	
	function refresh() {
		if (getCurrentPage() != 'schedule') {
			console.log("skipping refresh, we're not on the schedule page");
			return;
		}

		var html = '';
		var last_date = '';
		var type = getType();
		var events = [];
		
		if (type == 'favorite') {
			$.each(getAllEvents(), function(i, entry) {
				// console.log("event = " + entry.title);
				if (isFavorite(entry.id)) {
					// console.log("favorite = " + entry.title);
					events.push(entry);
				}
			});
		} else {
			events = get(type);
		}

		if (events == undefined || events.length == 0) {
			return;
		}

		scheduleIds = [];
		var scheduleEntry = 0;

		$.each(events, function(i, entry) {
			if (entry.title != undefined && entry.title['$t'] != undefined) {
				// old storage format found; return
				return;
			}

			var header = entry.title;

			if (entry.start != undefined) {
				var startDate = formatDate(entry.start);
				if (last_date != startDate) {
					html += '<li data-role="list-divider">' + startDate + '</li>' + "\n";
					last_date = startDate;
				}
				header += '<br /><span class="headersmall">Time: <span class="headertime">' + formatTime(entry.start) + '-' + formatTime(entry.end) + '</span></span>';
			}
				
			if (entry.location != undefined) {
				header += '<br /><span class="headersmall">Location: ' + entry.location + '</span>';
			}

			scheduleIds[scheduleEntry] = entry.id;
			var buttonThemeColor = normalTheme;
			if (type != 'favorite') {
				buttonThemeColor = (isFavorite(entry.id)? hilightTheme:normalTheme);
			}

			html += '<li data-theme="'+buttonThemeColor+'" data-icon="star" id="favorite-'+scheduleEntry+'"><a href="javascript:toggleFavorite('+scheduleEntry+');">' + "\n" +
				'<div>' + "\n"
				+ '<h3 style="white-space:normal">' + header + '</h3>' + "\n"
				+ '<p style="white-space:normal; font-size:13px">' + entry.content + '</p>' + "\n"
				+ '</div>' + "\n"
				+ '</a>' + "\n";
				// '<a data-split-icon="star" data-theme="' + buttonThemeColor + '" onClick="javascript:toggleFavorite(' + scheduleEntry + ');" id="favorite-' + scheduleEntry + '">Favorite</a></li>' + "\n";
				
				scheduleEntry++;
		});

		if(getCurrentPage() == 'schedule') {
			$('#calendar-list').html(html);
			favorites.save();
			$('#calendar-list').listview('refresh');
		}
	}

	function get(name) {
		try {
			if (phoneGapAvailable()) {
				val = window.localStorage.getItem(name);
				if (val) {
					return window.JSON.parse(window.localStorage.getItem(name), function(key, value) {
						if (key == 'start' || key == 'end') {
							return new Date(value);
						}
						return value;
					});
				}
			} else {
				return $.Storage.loadItem(name);
			}
		} catch (e) {
			console.log("failed to get " + name + ": " + e);
		}
		return undefined;
	}
	
	function save(name, obj) {
		if (obj == undefined) {
//			console.log("removing item " + name);
			if (phoneGapAvalable()) {
				return window.localStorage.removeItem(name);
			} else {
				return $.Storage.deleteItem(name);
			}
		}
		if (phoneGapAvailable()) {
			var stringify = window.JSON.stringify(obj);
			console.log("saving " + name);
			return window.localStorage.setItem(name, stringify);
		} else {
			return $.Storage.saveItem(name, obj);
		}
	}

	function CalendarEvent() {
		this.id       = undefined;
		this.title    = undefined;
		this.start    = undefined;
		this.end      = undefined;
		this.location = undefined;
		this.content  = undefined;
		
		this.toString = function() {
			return this.title + ' (' + this.start + ' to ' + this.end + ')';
		}
	}

	function handlePendingUpdates() {
		if (pendingUpdates.length > 0) {
			var update = pendingUpdates.shift();
			if (jocoOnline) {
				console.log("handlePendingUpdates: " + update.name);
				$.getJSON(update.url,
					function(json) {
						var calendarEvents = [];

						if (debug) {
							var calendarEvent = new CalendarEvent();
							calendarEvent.id=update.name + '-monkey';
							calendarEvent.title = "Test Event";
							calendarEvent.content = "This is a test event.";
							calendarEvent.location = "Someplace";
							calendarEvent.start = new Date((new Date()).getTime() + (17 * 60 * 1000));
							calendarEvent.end = new Date(calendarEvent.start.getTime() + (60 * 60 * 1000));
							calendarEvents.push(calendarEvent);
						}

						$.each(json.feed.entry, function(i, entry) {
							calendarEvent = new CalendarEvent();

							calendarEvent.id = entry.id['$t'];
							calendarEvent.title = entry.title['$t'];
							calendarEvent.content = entry.content['$t'];
							if (entry['gd$where'] && entry['gd$where'].length > 0) {
								calendarEvent.location = entry['gd$where'][0].valueString;
							}

							if (entry['gd$when']) {
								calendarEvent.start = getDateFromString(entry['gd$when'][0].startTime);
								calendarEvent.end   = getDateFromString(entry['gd$when'][0].endTime);
							}

							calendarEvents.push(calendarEvent);
						});

						// console.log(window.JSON.stringify(json));
						save(update.name, calendarEvents);
						handlePendingUpdates();
					}
				);
			} else {
				console.log("handlePendingUpdates: updates needed, but we are offline");
				handlePendingUpdates();
			}
		} else {
			console.log("handlePendingUpdates: no more updates needed");
			refresh();
		}
	}
	
	function updateData() {
		pendingUpdates.push({name:"official", url:
			"http://www.google.com/calendar/feeds/"
			+ "nh76o8dgn9d86b7n3p3uofg1q0%40group.calendar.google.com"
			+ "/public/full?alt=json-in-script"
//			+ "&ctz=Etc/UTC"
			+ "&ctz=America/New_York"
			+ "&orderby=starttime"
			+ "&sortorder=ascending"
			+ "&max-results=10000"
			+ "&start-min=2012-01-01T00:00:00-05:00"
			+ "&callback=?"
		});
		pendingUpdates.push({name:"unofficial", url:
			"https://www.google.com/calendar/feeds/"
			+ "6r0c1f3ltnhdlpbtpql79colos%40group.calendar.google.com"
			+ "/public/full?alt=json-in-script"
//			+ "&ctz=Etc/UTC"
			+ "&ctz=America/New_York"
			+ "&orderby=starttime"
			+ "&sortorder=ascending"
			+ "&max-results=10000"
			+ "&start-min=2012-01-01T00:00:00-05:00"
			+ "&callback=?"
		});
		handlePendingUpdates();
	}

	function updateDataIfOnline() {
		jocoOnline = false;

		if (pendingUpdates.length > 0) {
			// we're already doing this; skip
			return;
		}

		if (navigator.onLine) {
			// Just because the browser says we're online doesn't mean we're online. The browser lies.
			// Check to see if we are really online by making a call for a static JSON resource on
			// the originating Web site. If we can get to it, we're online. If not, assume we're
			// offline.
			$.ajax({
				async: true,
				cache: false,
				context: $(document.body),
				dataType: "jsonp",
				timeout: 5000,
				type: "GET",
				url: "http://www.raccoonfink.com/joco/online.html",
				success: function (data, status, req) {
					updateData();
				},
				error: function (req, status, ex) {
					if (jocoOnline) {
						updateData();
						return;
					}
					console.log("Error: request = " + window.JSON.stringify(req) + ", status = " + status + ", ex = " + ex);
					// We might not be technically "offline" if the error is not a timeout, but
					// otherwise we're getting some sort of error when we shouldn't, so we're
					// going to treat it as if we're offline.
					// Note: This might not be totally correct if the error is because the
					// manifest is ill-formed.
					refresh();
				}
			});
		} else {
			console.log("not online");
			refresh();
		}
	}

	function updateMapImage() {
		$('#select-westerdam-image').attr('src', 'images/' + $('#select-westerdam').val());
		return false;
	}

	function onMenu(show) {
		console.log("onMenu");
		return true;
	}

	function onSchedule(show) {
		console.log("onSchedule");
		if (show) {
			refresh();
			updateDataIfOnline();
		} else {
		}
		return true;
	}

	function onMap(show) {
		console.log("onMap");
		return true;
	}

	function onDefault(show) {
		console.log("onDefault");
		return true;
	}
	
	function nextDeckImage() {
		if (getCurrentPage() != 'map') { return; }
		var current = $('#select-westerdam option:selected');
		var nextObject = current.prev('option');
		if (nextObject != undefined && nextObject.val() != undefined) {
			current.removeAttr('selected');
			nextObject.attr('selected', 'selected');
			$('#select-westerdam').change();
		}
	}
	
	function previousDeckImage() {
		if (getCurrentPage() != 'map') { return; }
		var current = $('#select-westerdam option:selected');
		var previousObject = current.next('option');
		if (previousObject != undefined && previousObject.val() != undefined) {
			current.removeAttr('selected');
			previousObject.attr('selected', 'selected');
			$('#select-westerdam').change();
		}
	}
	
	function getCurrentPage() {
		return $.mobile.activePage.attr('id');
	}

	function freezeViewport() {
		console.log("freezeViewport");
		$('meta[name=viewport]').attr('content', 'width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no');
	}

	function unfreezeViewport() {
		console.log("unfreezeViewport");
		$('meta[name=viewport]').attr('content', 'width=device-width, initial-scale=1.0, user-scalable=yes');
	}
	
	$(document).bind('pageshow', function(event, data) {
		var activePage = getCurrentPage();
		// console.log('pageshow, active page = ' + activePage);

		switch(activePage) {
			case 'menu':     return onMenu(true);
			case 'schedule': return onSchedule(true);
			case 'map':      return onMap(true);
			default:         return onDefault(true);
		}
	});

	$('input, select, textarea').bind('focus blur',
		function(e) {
			$('meta[name="viewport"]').attr('content', 'width=device-width,initial-scale=1,maximum-scale=' + (e.type == 'blur' ? 10 : 1));
			// freezeViewport();
			// unfreezeViewport();
		}
	);

	/*
	var viewportMeta = $('meta[name="viewport"]');
	$('input, select, textarea').bind('focus blur', 
		function(event) {
			viewportMeta.attr('content', 'width=device-width,initial-scale=1,maximum-scale=' + (event.type == 'blur' ? 10 : 1));
		}
	);
	*/

	$(document).bind('pagebeforehide', function(event, data) {
		var activePage = getCurrentPage();
		// console.log('pagebeforehide, active page = ' + activePage);

		switch(activePage) {
			case 'menu':     return onMenu(false);
			case 'schedule': return onSchedule(false);
			case 'map':      return onMap(false);
			default:         return onDefault(false);
		}
	});

	/*
	$(document).bind('swipeleft', function(e, ui) {
		alert(e.type);
		if (getCurrentPage() == 'map') {
			nextDeckImage();
		}
	});
	$(document).bind('swiperight', function(e, ui) {
		alert(e.type);
		if (getCurrentPage() == 'map') {
			previousDeckImage();
		}
	});
	*/

	$(document).bind('mobileinit',
		function() {
			$.support.cors = true;
			$.mobile.allowCrossDomainPages = true;
		}
	);

	var lastUpdated = 0;
	var doUpdates = function() {
		var now = (new Date()).getTime();
		// every hour
		if (lastUpdated + (60 * 60 * 1000) < now) {
			console.log("updateDataIfOnline is out of date, running");
			updateDataIfOnline();
			lastUpdated = now;
		}
		checkForReminders();
		setTimeout(doUpdates, (60 * 1000));
	}

	$(document).ready(function() {
		var images = [
			"westerdam-11-sports.gif",
			"westerdam-10-observation.gif",
			"westerdam-09-lido.gif",
			"westerdam-08-navigation.gif",
			"westerdam-07-rotterdam.gif",
			"westerdam-06-upper-verandah.gif",
			"westerdam-05-verandah.gif",
			"westerdam-04-upper-promenade.gif",
			"westerdam-03-promenade.gif",
			"westerdam-02-lower-promenade.gif",
			"westerdam-01-main.gif"
		];
		
		$.each(images, function(i, image) {
			document.createElement('img').src = "images/" + image;
		});

		$.mobile.defaultPageTransition = 'none';
		setType('official');
		doUpdates();
		/*
		updateDataIfOnline();
		// update every 60 minutes
		refreshInterval = setInterval(updateDataIfOnline, 60 * 60 * 1000);
		// check every minute
		reminderInterval = setInterval(checkForReminders, 60 * 1000);
		*/
	});
	</script>
</head> 
<body> 

<div data-role="page" id="menu">
	<div data-role="header">
		<h1 style="white-space:normal">Cruise Monkey</h1>
	</div>
	
	<div data-role="content">
		<ul id="menu-list" data-role="listview" data-inset="true">
			<li><a href="#amenities">Amenities</a></li>
			<li><a href="#schedule">Schedule</a></li>
			<li><a href="#map">Map</a></li>
		</ul>
	</div>
</div>

<div data-role="page" id="amenities">
	<div data-role="header">
		<a href="#menu" data-rel="back" data-icon="arrow-l">Back</a>
		<h1 style="white-space:normal">Amenities</h1>
	</div>
	
	<div data-role="content">	
		<ul id="amenities-list" data-role="listview" data-filter="true" data-inset="true">
			<li data-role="list-divider">Deck 11 - Sports Deck</li>
			<li>Basketball Court</li>
			<li>Observation Deck</li>
			<li>Volleyball Court</li>
			<li data-role="list-divider">Deck 10 - Observation Deck</li>
			<li>Club HAL</li>
			<li>Explorations Cafe</li>
			<li>The Loft</li>
			<li>Ten Forward (Crow's Nest)</li>
			<li data-role="list-divider">Deck 9 - Lido Deck</li>
			<li>Canaletto Restaurant</li>
			<li>Fitness Center</li>
			<li>The Greenhouse Spa &amp; Salon</li>
			<li>Hydro Pool</li>
			<li>Lido Bar</li>
			<li>Lido Pool</li>
			<li>Lido Restaurant</li>
			<li>Sea View Bar</li>
			<li>Sea View Pool</li>
			<li>Terrace Grill (Restaurant)</li>
			<li>Therapy Rooms</li>
			<li>Thermal Suites</li>
			<li data-role="list-divider">Deck 8 - Navigation Deck</li>
			<li>Staterooms 8001-8147</li>
			<li data-role="list-divider">Deck 7 - Rotterdam Deck</li>
			<li>Concierge</li>
			<li>Neptune Lounge</li>
			<li>Staterooms 7001-7151</li>
			<li data-role="list-divider">Deck 6 - Upper Verandah Deck</li>
			<li>Staterooms 6001-6177</li>
			<li data-role="list-divider">Deck 5 - Verandah Deck</li>
			<li>Staterooms 5001-5191</li>
			<li data-role="list-divider">Deck 4 - Upper Promenade Deck</li>
			<li>Staterooms 4001-4185</li>
			<li data-role="list-divider">Deck 3 - Promenade Deck</li>
			<li>Atrium</li>
			<li>Erasmus Library</li>
			<li>Half Moon (Meeting Room)</li>
			<li>Hudson (Meeting Room)</li>
			<li>Merabella Luxury Shop</li>
			<li>Ocean Bar</li>
			<li>Photo Gallery</li>
			<li>Shopping Arcade</li>
			<li>Shops</li>
			<li>Stuyvesant (Meeting Room)</li>
			<li>Upper Vista Dining Room</li>
			<li>Vista Lounge Balcony</li>
			<li data-role="list-divider">Deck 2 - Lower Promenade Deck</li>
			<li>Atrium</li>
			<li>Casino</li>
			<li>Explorer's Lounge</li>
			<li>Lower Vista Dining Room</li>
			<li>Northern Lights Night Club</li>
			<li>Piano Bar</li>
			<li>Pinnacle Bar</li>
			<li>Pinnacle Grill (Restaurant)</li>
			<li>Queen's Lounge &amp; Culinary Arts Center</li>
			<li>Sports Bar</li>
			<li>Vista Lounge Balcony</li>
			<li data-role="list-divider">Deck 1 - Main Deck</li>
			<li>Atrium</li>
			<li>Front Office</li>
			<li>Future Cruises</li>
			<li>Shore Excursions</li>
			<li>Staterooms 1001-1127</li>
			<li>Vista Lounge</li>
		</ul>
	</div>
</div>

<div data-role="page" id="schedule">

	<div data-role="header">
		<a href="#menu" data-rel="back" data-icon="arrow-l">Back</a>
		<h1 style="text-align:left; margin-left:10px; white-space:normal"></h1>
		<form id="chooser" data-role="controlgroup" data-type="horizontal" style="display:inline" data-theme="a" class="ui-btn-right ui-btn ui-btn-corner-all ui-shadow uit-btn-up-a">
			<input type="radio" name="type-choice" id="type-choice-official"   value="official" checked="checked" onclick="javascript:updateType('official');" />
			<label for="type-choice-official" style="font-size:13px">Official</label>
			<input type="radio" name="type-choice" id="type-choice-unofficial" value="unofficial" onclick="javascript:updateType('unofficial');" />
			<label for="type-choice-unofficial" style="font-size:13px">Unofficial</label>
			<input type="radio" name="type-choice" id="type-choice-favorite" value="favorite" onclick="javascript:updateType('favorite');" />
			<label for="type-choice-favorite" style="font-size:13px">Favorite</label>
		</form>
	</div>

	<div data-role="content">	
		<ul id="calendar-list" data-role="listview" data-filter="true" data-inset="true" data-split-icon="star" data-split-theme="c">
			<li>loading...</li>
		</ul>
	</div>

</div>

<div data-role="page" id="map">
	<div id="map-header" data-role="header">
		<a href="#menu" data-rel="back" data-icon="arrow-l">Back</a>
		<h1 style="white-space:normal">Westerdam Map</h1>
	</div>
	
	<div data-role="content">
		<fieldset class="ui-grid-b">
		<div class="ui-block-a" style="margin-top:.5em"><a href="javascript:previousDeckImage();" data-role="button" data-icon="arrow-d" data-iconpos="notext" style="margin-right:auto">Down</a></div>
		<div class="ui-block-b">
			<select name="select-floor" id="select-westerdam" onChange="javascript:updateMapImage();">
				<option value="westerdam-11-sports.gif"                  >11 - Sports</option>
				<option value="westerdam-10-observation.gif"             >10 - Observation</option>
				<option value="westerdam-09-lido.gif" selected="selected">09 - Lido</option>
				<option value="westerdam-08-navigation.gif"              >08 - Navigation</option>
				<option value="westerdam-07-rotterdam.gif"               >07 - Rotterdam</option>
				<option value="westerdam-06-upper-verandah.gif"          >06 - Upper Verandah</option>
				<option value="westerdam-05-verandah.gif"                >05 - Verandah</option>
				<option value="westerdam-04-upper-promenade.gif"         >04 - Upper Promenade</option>
				<option value="westerdam-03-promenade.gif"               >03 - Promenade</option>
				<option value="westerdam-02-lower-promenade.gif"         >02 - Lower Promenade</option>
				<option value="westerdam-01-main.gif"                    >01 - Main Deck</option>
			</select>
		</div>
		<div class="ui-block-c" style="margin-top:.5em"><a href="javascript:nextDeckImage();" data-role="button" data-icon="arrow-u" data-iconpos="notext" style="margin-left:auto">Up</a></div>
		</fieldset>

		<img src="images/westerdam-09-lido.gif" id="select-westerdam-image" style="width:100%" />
	</div>
</div>

<div data-role="page" id="alert">
	<div data-role="header" data-theme="d">
		<h1 id="alert-title" style="white-space:normal">Alert!</h1>
	</div>
	
	<div data-role="content">
		<h1 id="alert-header" style="white-space:normal">Stuff!</h1>
		<p id="alert-text">This is an alert.</p>
		<a href="#menu" data-role="button" data-rel="back" id="alert-button">OK</a>
	</div>
</body>
</html>
